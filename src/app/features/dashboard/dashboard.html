<div class="min-h-screen bg-gray-50">

  <div class="container mx-auto px-6 py-8">
    <!-- 🏷️ Header Dashboard -->
    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8 gap-4">
      <div>
        <h2 class="text-3xl font-bold">{{ 'DASHBOARD.WELCOME_TITLE' | translate }}</h2>
        <p class="text-gray-600 text-lg">{{ 'DASHBOARD.WELCOME_SUBTITLE' | translate }}</p>
      </div>
      <button
        class="px-5 py-2 rounded-lg bg-blue-600 text-white font-semibold 
        shadow-md hover:bg-emerald-500 transition-colors 
        duration-600 flex items-center gap-2 cursor-pointer"
        (click)="addProperty()"
      >
        <i class="ph ph-plus-circle text-xl"></i>
        {{ 'DASHBOARD.ADD_PROPERTY' | translate }}
      </button>
    </div>

    <!-- Stats -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      @for (stat of stats(); track stat) {
        <div class="bg-white rounded-xl p-4 border border-gray-200 shadow 
        hover:shadow-xl transition-colors duration-600">
          <div class="flex items-center justify-between mb-2">
            <span class="text-sm text-gray-500">{{ stat.title | translate }}</span>
            <i class="ph {{stat.icon}} text-xl" [ngClass]="stat.color"></i>
          </div>
          <div class="text-2xl font-bold">{{ stat.value }}</div>
          <p class="text-xs text-gray-500">{{ stat.change }}</p>
        </div>
      }
    </div>

    <div class="grid lg:grid-cols-3 gap-8">
      <!-- Properties -->
      <div class="lg:col-span-2 space-y-6">
        <div class="bg-white rounded-xl border border-gray-200 p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3 class="font-semibold">{{ 'DASHBOARD.PROPERTIES.TITLE' | translate }}</h3>
              <p class="text-sm text-gray-500">{{ 'DASHBOARD.PROPERTIES.SUBTITLE' | translate }}</p>
            </div>
            <button class="px-3 py-1 border border-gray-100 rounded flex items-center 
            gap-1 text-sm hover:bg-amber-500 cursor-pointer transition">
              <i class="ph ph-plus"></i> {{ 'DASHBOARD.PROPERTIES.ADD' | translate }}
            </button>
          </div>
          <div class="flex items-center gap-4 mb-4">
            <div class="relative flex-1">
              <i class="ph ph-magnifying-glass absolute left-3 top-3 text-gray-400"></i>
              <input type="text" [(ngModel)]="searchQuery"
                     class="w-full pl-9 border border-gray-100 rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                     placeholder="{{ 'DASHBOARD.PROPERTIES.SEARCH' | translate }}">
            </div>
            <button class="p-2 border border-gray-100 rounded hover:bg-gray-100 transition">
              <i class="ph ph-funnel"></i>
            </button>
          </div>
          <div class="space-y-4">
            @for (property of properties(); track property) {
              <div class="flex items-center justify-between p-4 rounded-lg border border-gray-100 hover:bg-gray-50 transition">
                <div class="flex items-center gap-4">
                  <div class="w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center text-white">
                    <i class="ph ph-buildings text-2xl"></i>
                  </div>
                  <div>
                    <h4 class="font-semibold">{{ property.address }}</h4>
                    <p class="text-sm text-gray-500">{{ property.type }}</p>
                    @if (property.tenant) {
                      <p class="text-sm text-gray-500">{{ 'DASHBOARD.PROPERTIES.TENANT' | translate }}: {{ property.tenant }}</p>
                    }
                  </div>
                </div>
                <div class="flex items-center gap-4">
                  <div class="text-right">
                    <p class="font-semibold">{{ property.rent }}</p>
                    @if (property.nextDue) {
                      <p class="text-xs text-gray-500">{{ 'DASHBOARD.PROPERTIES.DUE' | translate }}: {{ property.nextDue }}</p>
                    }
                  </div>

                  <span [ngClass]="getStatusBadge(property.status).classes">
                    {{ getStatusBadge(property.status).label | translate }}
                  </span>

                  <button (click)="goTo('/property/'+property.id)"
                          class="px-3 py-1 border border-gray-100 rounded text-sm
                           hover:bg-amber-500 cursor-pointer transition">
                    {{ 'DASHBOARD.PROPERTIES.DETAILS' | translate }}
                  </button>

                  <!-- Kebab + menu -->
                  <div class="relative">
                    <button type="button"
                            class="p-2 rounded hover:bg-gray-100 transition"
                            (click)="toggleMenu(property.id, $event)">
                      <i class="ph ph-dots-three-outline-vertical text-gray-600"></i>
                    </button>

                    @if (openMenuId() === property.id) {
                      <div class="absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-md shadow-lg z-20"
                          (click)="$event.stopPropagation()">
                        <ul class="py-2 text-sm">
                          <li>
                            <button class="w-full px-4 py-2 flex items-center gap-2 text-left hover:bg-gray-50"
                                    (click)="goTo('/property/'+property.id); closeMenu()">
                              <i class="ph ph-eye"></i>
                              {{ 'DASHBOARD.PROPERTIES.MENU.DETAILS' | translate }}
                            </button>
                          </li>
                          <li>
                            <button class="w-full px-4 py-2 flex items-center gap-2 text-left hover:bg-gray-50"
                                    (click)="editProperty(property.id)">
                              <i class="ph ph-pencil-simple-line"></i>
                              {{ 'DASHBOARD.PROPERTIES.MENU.EDIT' | translate }}
                            </button>
                          </li>
                          <li>
                            <button class="w-full px-4 py-2 flex items-center gap-2 text-left hover:bg-red-50 text-red-600"
                                    (click)="deleteProperty(property.id)">
                              <i class="ph ph-trash"></i>
                              {{ 'DASHBOARD.PROPERTIES.MENU.DELETE' | translate }}
                            </button>
                          </li>
                        </ul>
                      </div>
                    }
                  </div>
                </div>
              </div>
            }
          </div>
        </div>
      </div>

      <!-- Sidebar -->
      <div class="space-y-6">
        <div class="bg-white rounded-xl border border-gray-200 p-6">
          <h3 class="font-semibold mb-4 flex items-center gap-2">
            <i class="ph ph-calendar"></i> {{ 'DASHBOARD.DEADLINES.TITLE' | translate }}
          </h3>
          <div class="p-3 bg-red-50 border border-red-200 rounded mb-2">
            <p class="text-sm font-medium">{{ 'DASHBOARD.DEADLINES.LATE_RENT' | translate }}</p>
            <p class="text-xs text-gray-500">Boulevard Voltaire — 3 {{ 'DASHBOARD.DEADLINES.DAYS' | translate }}</p>
          </div>
          <div class="p-3 bg-gray-50 rounded mb-2">
            <p class="text-sm font-medium">{{ 'DASHBOARD.DEADLINES.NEXT' | translate }}</p>
            <p class="text-xs text-gray-500">15 Rue de la Paix — 2 {{ 'DASHBOARD.DEADLINES.DAYS' | translate }}</p>
          </div>
          <div class="p-3 bg-gray-50 rounded">
            <p class="text-sm font-medium">{{ 'DASHBOARD.DEADLINES.RENEWAL' | translate }}</p>
            <p class="text-xs text-gray-500">Studio Lyon — 15 {{ 'DASHBOARD.DEADLINES.DAYS' | translate }}</p>
          </div>
        </div>

        <div class="bg-white rounded-xl  border-gray-200 p-6">
          <h3 class="font-semibold mb-4">{{ 'DASHBOARD.RECENT_ACTIVITY.TITLE' | translate }}</h3>
          <div *ngFor="let activity of recentActivities()" class="flex items-start gap-3 mb-3">
            <i [class]="getActivityIcon(activity.type)"></i>
            <div>
              <p class="text-sm font-medium">
                  {{ 'DASHBOARD.ACTIVITIES.' + activity.type.toUpperCase() | translate }} — {{ activity.message }}
                </p>
              <p *ngIf="activity.amount" class="text-sm text-green-600 font-semibold">{{ activity.amount }}</p>
              <p class="text-xs text-gray-500">{{ activity.time }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Access -->
    <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="cursor-pointer  rounded-xl p-6 text-center hover:shadow-lg bg-white" (click)="goTo('/contracts')">
        <div class="text-blue-500 text-3xl mb-2"><i class="ph ph-file-text"></i></div>
        <h4 class="font-semibold">{{ 'DASHBOARD.SHORTCUTS.CONTRACTS.TITLE' | translate }}</h4>
        <p class="text-sm text-gray-500">{{ 'DASHBOARD.SHORTCUTS.CONTRACTS.DESC' | translate }}</p>
      </div>
      <div class="cursor-pointer  rounded-xl p-6 text-center hover:shadow-lg bg-white" (click)="goTo('/financial')">
        <div class="text-yellow-500 text-3xl mb-2"><i class="ph ph-calculator"></i></div>
        <h4 class="font-semibold">{{ 'DASHBOARD.SHORTCUTS.ACCOUNTING.TITLE' | translate }}</h4>
        <p class="text-sm text-gray-500">{{ 'DASHBOARD.SHORTCUTS.ACCOUNTING.DESC' | translate }}</p>
      </div>
      <div class="cursor-pointer  rounded-xl p-6 text-center hover:shadow-lg bg-white" (click)="goTo('/documents')">
        <div class="text-green-600 text-3xl mb-2"><i class="ph ph-file"></i></div>
        <h4 class="font-semibold">{{ 'DASHBOARD.SHORTCUTS.DOCS.TITLE' | translate }}</h4>
        <p class="text-sm text-gray-500">{{ 'DASHBOARD.SHORTCUTS.DOCS.DESC' | translate }}</p>
      </div>
      <div class="cursor-pointer  rounded-xl p-6 text-center hover:shadow-lg bg-white" (click)="goTo('/profitability')">
        <div class="text-green-500 text-3xl mb-2"><i class="ph ph-trend-up"></i></div>
        <h4 class="font-semibold">{{ 'DASHBOARD.SHORTCUTS.PROFIT.TITLE' | translate }}</h4>
        <p class="text-sm text-gray-500">{{ 'DASHBOARD.SHORTCUTS.PROFIT.DESC' | translate }}</p>
      </div>
      <div class="cursor-pointer  rounded-xl p-6 text-center hover:shadow-lg bg-white" (click)="goTo('/settings')">
        <div class="text-gray-500 text-3xl mb-2"><i class="ph ph-gear"></i></div>
        <h4 class="font-semibold">{{ 'DASHBOARD.SHORTCUTS.SETTINGS.TITLE' | translate }}</h4>
        <p class="text-sm text-gray-500">{{ 'DASHBOARD.SHORTCUTS.SETTINGS.DESC' | translate }}</p>
      </div>
    </div>
  </div>
</div>
