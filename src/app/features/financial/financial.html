<div class="w-full space-y-6">

  <!-- Header -->
  <div class="flex items-center justify-end">
    <div class="flex gap-2">
      <button class="flex items-center px-3 py-2 bg-gray-100 hover:bg-gray-200 text-sm rounded-md transition">
        <i class="ph ph-download-simple mr-1"></i> Exporter
      </button>
      <select
        class="rounded-md border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        <option>2024</option>
        <option>2023</option>
      </select>
    </div>
  </div>

  <h1 class="text-xl font-semibold text-gray-800">Comptabilité & Projections</h1>

  <!-- Onglets -->
  <div class="bg-gray-50 rounded-md flex overflow-x-auto">
    <button *ngFor="let tab of tabs"
            (click)="setTab(tab)"
            class="px-6 py-3 text-sm font-medium transition"
            [ngClass]="activeTab === tab
            ? 'text-gray-900 bg-white rounded-t-md border-b-2 border-white shadow-sm'
            : 'text-gray-600 hover:text-gray-900 hover:bg-gray-100'">
      {{ tab }}
    </button>
  </div>

  <!-- === VUE D'ENSEMBLE, FLUX DE TRÉSORERIE, ANALYSE DES CHARGES, PROJECTIONS === -->
  @switch (activeTab) {
    @case ('Vue d\'ensemble') {
      <!-- Statistiques -->
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div *ngFor="let s of stats"
             class="bg-white rounded-md shadow p-4 flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">{{ s.title }}</p>
            <p class="text-2xl font-bold" [ngClass]="s.changeColor">{{ s.value }}</p>
            <p class="text-xs mt-1" [ngClass]="s.changeColor">{{ s.change }}</p>
          </div>
          <i class="text-3xl" [class]="s.icon + ' ' + s.changeColor"></i>
        </div>
      </div>

      <!-- Graphique + échéances -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        <div class="bg-white rounded-md shadow p-4">
          <h3 class="text-sm font-semibold text-gray-800 flex items-center mb-3">
            <i class="ph ph-chart-line-up mr-2 text-gray-500"></i> Évolution des revenus
          </h3>
          <div class="h-48 bg-gray-100 flex items-center justify-center text-gray-400 text-sm">
            Graphique des revenus (6 derniers mois)
          </div>
        </div>

        <div class="bg-white rounded-md shadow p-4">
          <h3 class="text-sm font-semibold text-gray-800 flex items-center mb-3">
            <i class="ph ph-calendar-blank mr-2 text-gray-500"></i> Échéances à venir
          </h3>
          <div class="space-y-3">
            <div *ngFor="let u of upcoming" class="flex items-center justify-between border border-gray-300 rounded-md p-3">
              <div>
                <p class="text-sm font-medium text-gray-800">{{ u.label }}</p>
                <p class="text-xs text-gray-500">Échéance: {{ u.due }}</p>
              </div>
              <div class="text-right">
                <p class="text-sm font-semibold" [ngClass]="u.amount>=0?'text-green-600':'text-red-600'">
                  {{ u.amount>=0? '+'+u.amount : u.amount }}€
                </p>
                <span class="px-2 py-0.5 text-xs rounded-full"
                      [ngClass]="u.status==='en-attente'
                      ?'bg-green-100 text-green-700'
                      :'bg-red-100 text-red-700'">
                  {{u.status==='en-attente'?'En attente':'À payer'}}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Performance par bien -->
      <div class="bg-white rounded-md shadow p-4">
        <h3 class="text-sm font-semibold text-gray-800 mb-3">Performance par bien</h3>
        <div class="space-y-3">
          <div *ngFor="let p of properties"
               class="flex items-center justify-between border border-gray-300 rounded-md p-3">
            <div>
              <p class="text-sm font-medium text-gray-800">{{p.name}}</p>
              <p class="text-xs text-gray-500">
                Revenus: {{p.revenue}}€ | Charges: {{p.charges}}€
              </p>
            </div>
            <div class="text-right">
              <p class="text-sm font-semibold text-green-600">+{{p.revenue-p.charges}}€</p>
              <p class="text-xs text-gray-500">ROI: {{p.roi}}%</p>
            </div>
          </div>
        </div>
      </div>
    }
    @case ('Flux de trésorerie') {
      <div class="bg-white rounded-md shadow p-4 mb-6">
        <h3 class="text-sm font-semibold text-gray-800 mb-3">Flux de trésorerie mensuel</h3>
        <div class="h-56 bg-gray-100 flex items-center justify-center text-gray-400 text-sm">
          Graphique de flux de trésorerie détaillé
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="bg-white rounded-md shadow p-4">
          <h3 class="text-sm font-semibold text-gray-800 mb-3">Entrées d'argent</h3>
          <ul class="space-y-2">
            <li *ngFor="let i of incomes" class="flex justify-between text-sm">
              <span class="text-gray-700">{{i.label}}</span>
              <span class="text-green-600 font-semibold">+{{i.amount}}€</span>
            </li>
          </ul>
        </div>
        <div class="bg-white rounded-md shadow p-4">
          <h3 class="text-sm font-semibold text-gray-800 mb-3">Sorties d'argent</h3>
          <ul class="space-y-2">
            <li *ngFor="let e of expenses" class="flex justify-between text-sm">
              <span class="text-gray-700">{{e.label}}</span>
              <span class="text-red-600 font-semibold">{{e.amount}}€</span>
            </li>
          </ul>
        </div>
      </div>
    }
    @case ('Analyse des charges') {
      <div class="space-y-6">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Répartition -->
      <div class="bg-white rounded-md shadow p-4">
        <h3 class="text-sm font-semibold text-gray-800 mb-3">Répartition des charges</h3>
        <div class="mb-4">
    <div class="flex justify-between text-sm mb-1">
      <span class="text-gray-700">Travaux & Réparations</span>
      <span class="font-medium text-gray-800">2400€ <span class="text-gray-500">(35%)</span></span>
    </div>
    <div class="w-full bg-gray-100 h-2 rounded-full">
      <div class="bg-blue-500 h-2 rounded-full" style="width:35%"></div>
    </div>
  </div>

  <div class="mb-4">
    <div class="flex justify-between text-sm mb-1">
      <span class="text-gray-700">Charges de copropriété</span>
      <span class="font-medium text-gray-800">1800€ <span class="text-gray-500">(26%)</span></span>
    </div>
    <div class="w-full bg-gray-100 h-2 rounded-full">
      <div class="bg-green-500 h-2 rounded-full" style="width:26%"></div>
    </div>
  </div>

  <div class="mb-4">
    <div class="flex justify-between text-sm mb-1">
      <span class="text-gray-700">Assurances</span>
      <span class="font-medium text-gray-800">950€ <span class="text-gray-500">(14%)</span></span>
    </div>
    <div class="w-full bg-gray-100 h-2 rounded-full">
      <div class="bg-amber-500 h-2 rounded-full" style="width:14%"></div>
    </div>
  </div>

  <div class="mb-4">
    <div class="flex justify-between text-sm mb-1">
      <span class="text-gray-700">Frais de gestion</span>
      <span class="font-medium text-gray-800">720€ <span class="text-gray-500">(10%)</span></span>
    </div>
    <div class="w-full bg-gray-100 h-2 rounded-full">
      <div class="bg-gray-300 h-2 rounded-full" style="width:10%"></div>
    </div>
  </div>

  <div class="mb-4">
    <div class="flex justify-between text-sm mb-1">
      <span class="text-gray-700">Taxes</span>
      <span class="font-medium text-gray-800">680€ <span class="text-gray-500">(10%)</span></span>
    </div>
    <div class="w-full bg-gray-100 h-2 rounded-full">
      <div class="bg-yellow-400 h-2 rounded-full" style="width:10%"></div>
    </div>
  </div>

  <div>
    <div class="flex justify-between text-sm mb-1">
      <span class="text-gray-700">Autres</span>
      <span class="font-medium text-gray-800">350€ <span class="text-gray-500">(5%)</span></span>
    </div>
    <div class="w-full bg-gray-100 h-2 rounded-full">
      <div class="bg-red-500 h-2 rounded-full" style="width:5%"></div>
    </div>
  </div>
        <!-- … autres lignes identiques -->
      </div>

      <!-- Evolution -->
      <div class="bg-white rounded-md shadow p-4">
        <h3 class="text-sm font-semibold text-gray-800 mb-3">Évolution des charges</h3>
        <div class="h-48 bg-gray-100 flex items-center justify-center text-gray-400 text-sm">
          Graphique d’évolution des charges
        </div>
      </div>
    </div>

    <!-- Optimisations -->
    <div class="bg-white rounded-md shadow p-4">
      <h3 class="text-sm font-semibold text-gray-800 mb-3">Optimisations recommandées</h3>
      <div class="space-y-3">
        <div class="p-3 rounded-md border border-gray-300 bg-yellow-50">
          <p class="text-sm font-medium text-gray-800">Négocier les contrats d’assurance</p>
          <p class="text-xs text-gray-600">Économie potentielle : 200€/mois</p>
        </div>
        <div class="p-3 rounded-md border border-gray-300 bg-blue-50">
          <p class="text-sm font-medium text-gray-800">Regrouper les travaux</p>
          <p class="text-xs text-gray-600">Réduction des frais d’intervention : 15%</p>
        </div>
      </div>
    </div>
  </div>
    }
    @case ('Projections') {
      <div class="space-y-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="bg-white rounded-md shadow p-4">
        <p class="text-sm text-gray-500">Projection 12 mois</p>
        <p class="text-2xl font-bold text-green-600">+210 000€</p>
        <p class="text-xs text-green-600 mt-1">+12% vs année précédente</p>
      </div>
      <div class="bg-white rounded-md shadow p-4">
        <p class="text-sm text-gray-500">Projection 5 ans</p>
        <p class="text-2xl font-bold text-green-600">+1 150 000€</p>
        <p class="text-xs text-green-600 mt-1">Croissance moyenne : 8.5%</p>
      </div>
      <div class="bg-white rounded-md shadow p-4">
        <p class="text-sm text-gray-500">ROI projeté</p>
        <p class="text-2xl font-bold text-green-600">9.2%</p>
        <p class="text-xs text-green-600 mt-1">Objectif dépassé</p>
      </div>
    </div>

    <div class="bg-white rounded-md shadow p-4">
      <h3 class="text-sm font-semibold text-gray-800 mb-3">Scénarios de projection</h3>
      <div class="h-48 bg-gray-100 flex items-center justify-center text-gray-400 text-sm">
        Graphique de projections avec scénarios optimiste / réaliste / pessimiste
      </div>
    </div>

    <div class="bg-white rounded-md shadow p-4">
      <h3 class="text-sm font-semibold text-gray-800 mb-3">Opportunités d'investissement</h3>
      <div class="border border-gray-300 rounded-md p-4 flex flex-col md:flex-row md:items-center md:justify-between">
        <div>
          <p class="text-sm font-medium text-gray-800">Acquisition bien #4</p>
          <p class="text-xs text-gray-500">Appartement 2 pièces - Quartier émergent</p>
          <p class="text-xs mt-1"><span class="font-medium">Prix :</span> 180 000€ | <span class="font-medium">Loyer estimé :</span> 1 100€/mois</p>
        </div>
        <div class="text-right mt-2 md:mt-0">
          <p class="text-sm font-semibold text-green-600">ROI projeté : 7.3%</p>
        </div>
      </div>
    </div>
  </div>
    }
  }
</div>
