@if (!menuInHeader()) {
  <!-- Sidebar (desktop + tablet) -->
  <div
    class="h-screen overflow-hidden p-5 pt-8 relative transition-all duration-300 flex-col justify-between hidden md:flex"
    [ngClass]="theme()?.sidebar"
    [class.w-72]="opened()"
    [class.w-20]="!opened()"
  >
    <!-- Toggle Icon -->
    <i
      class="ph"
      [class.ph-caret-double-left]="opened()"
      [class.ph-caret-double-right]="!opened()"
      class="text-white text-3xl absolute top-9 rounded-full border border-gray-800 
      cursor-pointer transition-all duration-300 -right-3 z-[2000]"
      (click)="onToggleSidebar.emit()"
    ></i>

    <!-- Top section -->
    <div>
      <!-- Logo -->
      <div class="inline-flex items-center">
        <i
          class="ph ph-map-pin text-white text-3xl mr-2 bg-amber-300 rounded cursor-pointer transition-transform duration-500"
          [class.rotate-[360deg]]="opened()"
        ></i>
        <h1 class="text-white origin-left text-2xl transition-all duration-300" [class.scale-0]="!opened()">
          {{ 'SIDEBAR.APP_NAME' | translate }}
        </h1>
      </div>

      <!-- Separator -->
      <hr class="border-gray-600 my-4" />

      <!-- Search -->
      <div class="flex items-center rounded-md bg-gray-900 px-3 py-2">
        <i class="ph ph-magnifying-glass text-white text-lg"></i>
        <input
          type="text"
          [placeholder]="'SIDEBAR.SEARCH' | translate"
          class="text-base w-full text-white bg-transparent focus:outline-none pl-2 transition-all duration-300"
          [class.w-0]="!opened()"
          [class.w-full]="opened()"
        />
      </div>

      <!-- Menu Items -->
      <ul class="pt-2">
        @for (menu of Menus(); track menu.title) {
          <li class="text-gray-300 text-sm flex flex-col mt-2">
          <!-- Main Menu -->
          <a
            class="flex items-center gap-x-4 p-2 hover:bg-gray-700 rounded-md transition-colors"
            [ngClass]="{ 'mt-9': menu.spacing }"
            [routerLink]="menu.route"
            routerLinkActive="bg-gray-700 text-white"
            (click)="menu.submenu ? onToggleSubmenu.emit(menu) : null"
          >
            <i class="ph {{menu.icon}} text-lg"></i>
            <span
              class="origin-left duration-200 font-semibold flex-1"
              [class.scale-0]="!opened()"
            >
              {{ menu.title | translate }}
            </span>
            @if (menu.submenu) {
              <i
                class="ph ph-caret-down text-xs transition-transform duration-300"
                [class.rotate-180]="menu.open"
                [class.scale-0]="!opened()"
              ></i>
            }
          </a>

          <!-- Submenu -->
          @if (menu.submenu && menu.open) {
            <ul class="pl-8 text-gray-400 text-sm transition-all duration-300">
              @for (sub of menu.submenuItems; track sub.title) {
                <li>
                  <a
                    class="flex items-center gap-x-3 py-1 hover:text-white transition-colors"
                    [routerLink]="sub.route"
                    routerLinkActive="text-white font-medium"
                  >
                    <i class="ph {{sub.icon}} text-xs"></i>
                    <span [class.scale-0]="!opened()">{{ sub.title | translate }}</span>
                  </a>
                </li>
              }
            </ul>
          }
        </li>
      }
    </ul>

    </div>

    <!-- Bottom section -->
    <div>
      <hr class="border-gray-600 my-4" />
      <button class="w-full flex items-center gap-x-3 p-2 text-red-400 hover:bg-gray-700 rounded-md" (click)="logout()">
        <i class="ph ph-sign-out"></i>
        <span [class.scale-0]="!opened()">{{ 'SIDEBAR.LOGOUT' | translate }}</span>
      </button>
    </div>
  </div>
}

<!-- Sidebar overlay (mobile only) -->
@if (mobileSidebar()) {
  <div class="fixed inset-0 z-[998] flex md:hidden" [ngClass]="theme()?.sidebar">
    <!-- Overlay gris -->
    <div class="absolute inset-0 bg-black bg-opacity-50" (click)="onCloseMobileSidebar.emit()"></div>

    <!-- Sidebar mobile -->
    <div class="relative w-72 p-5 pt-8 z-[999] transition-transform duration-300" [ngClass]="theme()?.sidebar">
      <!-- Bouton close -->
      <i class="ph ph-x text-white text-2xl absolute top-5 right-5 cursor-pointer" (click)="onCloseMobileSidebar.emit()"></i>

      <!-- Logo -->
      <div class="inline-flex items-center">
        <i class="ph ph-map-pin text-white text-3xl mr-2 bg-amber-300 rounded cursor-pointer"></i>
        <h1 class="text-white text-2xl">{{ 'SIDEBAR.APP_NAME' | translate }}</h1>
      </div>

      <!-- Separator -->
      <hr class="border-gray-600 my-4" />

      <!-- Menu Items -->
      <ul class="pt-2">
        @for (menu of Menus(); track menu.title) {
          <li class="text-gray-300 text-sm flex flex-col cursor-pointer mt-2" (click)="menu.submenu ? onToggleSubmenu.emit(menu) : null">
            <div class="flex items-center gap-x-4 p-2 hover:bg-gray-700 rounded-md" [ngClass]="{ 'mt-9': menu.spacing }">
              <i class="ph {{menu.icon}} text-lg"></i>
              <span class="font-semibold flex-1">{{ menu.title | translate }}</span>
              @if (menu.submenu) {
                <i class="ph ph-caret-down text-xs transition-transform duration-300" [class.rotate-180]="menu.open"></i>
              }
            </div>

            @if (menu.submenu && menu.open) {
              <ul class="pl-8 text-gray-400 text-sm transition-all duration-300">
                @for (sub of menu.submenuItems; track sub.title) {
                  <li class="flex items-center gap-x-3 py-1 hover:text-white">
                    <i class="ph {{sub.icon}} text-xs"></i>
                    <span>{{ sub.title | translate }}</span>
                  </li>
                }
              </ul>
            }
          </li>
        }
      </ul>

      <!-- Bottom section -->
      <div>
        <hr class="border-gray-600 my-4" />
        <button class="w-full flex items-center gap-x-3 p-2 text-red-400 hover:bg-gray-700 rounded-md" (click)="logout()">
          <i class="ph ph-sign-out"></i>
          <span>{{ 'SIDEBAR.LOGOUT' | translate }}</span>
        </button>
      </div>
    </div>
  </div>
}
